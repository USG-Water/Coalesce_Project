fileVersion: 1
id: edc43f82-57bb-4b33-910d-422d5eac7120
name: STG_TAM_OPEN_OPPORTUNITIES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a19c045f-4506-4119-b7f7-1ec3c3cf05e7
          stepCounter: edc43f82-57bb-4b33-910d-422d5eac7120
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f8fcee-248b-48ee-a229-fe46b14b823b
                stepCounter: 7dae76b9-2ca5-4486-98ec-f762786bf9ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4cef510-6907-4871-8212-eba91dd53b5c
          stepCounter: edc43f82-57bb-4b33-910d-422d5eac7120
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: OSC_OPTY_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d40f5ee5-9db3-461d-a859-f04ee1123440
                stepCounter: 7dae76b9-2ca5-4486-98ec-f762786bf9ce
            transform: MAX_BY("STG_OPPORTUNITIES"."OSC_OPTY_ID", "STG_OPPORTUNITIES"."CREATION_DATE")
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_OPPORTUNITIES: 7dae76b9-2ca5-4486-98ec-f762786bf9ce
          STG_OSC_SALES_STAGE: 3d7202fc-05b8-4477-963c-7530a72f27aa
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_OPPORTUNITIES
          - locationName: USG_STG_ORACLE_SALES_CLOUD
            nodeName: STG_OSC_SALES_STAGE
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_MASTER', 'STG_OPPORTUNITIES') }} "STG_OPPORTUNITIES"
            INNER JOIN {{ ref('USG_STG_ORACLE_SALES_CLOUD', 'STG_OSC_SALES_STAGE') }} "STG_OSC_SALES_STAGE"
                ON "STG_OPPORTUNITIES"."CURR_STG_ID" = "STG_OSC_SALES_STAGE"."STG_ID"
                AND "STG_OSC_SALES_STAGE"."STATUS" = 'OPEN'
            GROUP BY "STG_OPPORTUNITIES"."ACCOUNT_ID"
        name: STG_TAM_OPEN_OPPORTUNITIES
        noLinkRefs: []
  name: STG_TAM_OPEN_OPPORTUNITIES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
