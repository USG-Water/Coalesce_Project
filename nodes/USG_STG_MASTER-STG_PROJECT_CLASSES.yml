fileVersion: 1
id: fba952f9-d30d-4dce-8c6e-1252050cb1c0
name: STG_PROJECT_CLASSES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Clean up project classes after pivot
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecd255a4-e32c-408a-a10d-2023d47e9565
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROJECT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f9dc605-c268-4ca0-b0f0-039e97a89085
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d66a06b4-a1a5-46a7-a43e-5ff8ac3fe7fb
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_HEIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COALESCE("STG_PROJECT_CLASSES_UNIQUE"."'Tank Height'", "STG_PROJECT_CLASSES_UNIQUE"."'TANK HEIGHT'", "STG_PROJECT_CLASSES_UNIQUE"."'TOWER HEIGHT'")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eccb477d-2155-4531-8d49-7a1a8e1fde5d
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CONTRACT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4609dd90-3bd6-4a56-b068-c8757e47b249
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: |-
              CASE
                  WHEN "STG_PROJECT_CLASSES_UNIQUE"."CONTRACT_TYPE" ILIKE 'MP%' THEN 'MP'
                  ELSE "STG_PROJECT_CLASSES_UNIQUE"."CONTRACT_TYPE"
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a152a6d-f60c-4045-88b4-173efead629d
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: BASE_FEE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d7bdd0c-39fa-4344-8944-e4551b28df51
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd4c20d9-f2d1-40a1-ae55-0fbdbaa98731
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: BILL_INCR_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98ae415a-8b90-46cd-b2ad-bffcac2b8041
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a8d2ddd-3344-4cff-86a9-dd9b240d0657
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: BILL_INCR_YEAR_START_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de2ee503-0cbf-4f6f-a107-6a7895c3594f
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c54257f-3235-41c0-a54c-aa8720f8321d
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: BILLING_FREQUENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f04494b8-c346-41e4-949f-11e0af082210
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6342983-c49d-4edc-806b-f710ef83a691
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CANCELLATION_FINAL_APPROVAL_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a6bdeec-1b95-4d5b-9641-3b4022ce6ae1
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf098b0d-7f81-4c05-92ee-f9576ecc2b31
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CANCELLATION_NOTIFICATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 520a92e2-3359-4eef-9484-b93e691795cd
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ed08e08-a7b3-4626-876a-6689dade444e
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60659893-c7ad-4a29-b49c-fb2c94e2b25e
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b67eed52-9a89-4eff-a726-7f3bedd0730c
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CANCELLATION_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bea58395-d369-499a-b69a-785f4bf74c81
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30f0565b-7ed3-4f64-be75-f4d7cf7270de
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: COASTAL_TANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b16b4969-e4ee-4ae5-8d8d-89717cb74212
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8a8d8d2-28aa-4b55-bc80-13aaba84c432
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CORRAL_MOUNT_DIAMETER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0eccf44-62f6-4d3c-b80c-a85f39cba66f
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0701ec48-f4d4-4ace-9856-da699fec5653
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: CONCRETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cff1dca-0536-4c34-a1fe-1f843682fce7
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 817ccf14-571f-4a6c-98c8-b7bfb03bf7c5
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: GENERAL_ANTENNA_INFO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1753a137-013b-496b-a7f8-90e2dfea5dd6
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5a8a049-b812-44d4-ba3b-568a74c6b72c
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: MAP_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bdc3943-fa75-4432-b1f0-198646570570
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 028e8ae7-ad61-43d0-80e9-2ca0d8fc3a41
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: MARKET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 045484d6-1171-41cf-96dd-2c7ae11d8104
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc8ccd90-bbc3-43e7-816b-348eeedd7236
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PAINT_TYPE_EXTERIOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 718844c0-9e43-4820-9e33-7f6bc3ebaac7
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 628ad010-d779-42cd-8cd0-a3754450b17b
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PAINT_TYPE_INTERIOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c38d800-c921-4135-91b7-cfc37168d0fc
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b43a8d5-7c6c-49ae-a7ae-8ab898ff7b58
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: PE_FREQUENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f471ae8-3df5-497b-98e3-73edd64afaf6
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f946b64-c712-4c6f-8a33-c8745984de96
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: REGION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34d5e11f-d8e5-4ef6-a304-85a7d65e30f1
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a80844a-c22d-452b-9bd0-9e7611cce4c4
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: RISER/FILL_PIPE_DIAMETER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1637fd57-b437-419f-818a-2ffce60106c0
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a19ac3e-fcf8-4b06-b6bd-7a65d1c19b6d
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: RISER/SHELL_MANWAY_DIAMETER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79423f06-8c7e-4165-a613-118913c0e848
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e37197a8-9591-4d5d-b317-d6916a2ca743
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: ROOF_HATCH_DIAMETER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5615fea3-6c6b-49df-9cd6-a8af37277783
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bf8418c-7b2b-47bb-ab56-0bee2172a9fa
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: SBT_PROJECT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a1b21fd-1ea5-423f-9dc1-864d85daa4df
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4547e2a-b6d9-4035-87ad-0474439afa6d
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: SCOPE_OF_WORK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 466f4c3f-e9f3-43e0-875d-066ffe57b258
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5009ac7a-15f9-4f08-8ce6-93235ce05dc1
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_DIAMETER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ef93182-2f59-40a2-a645-1414c43c92c8
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60e22370-2178-452f-96e9-e6e1247a98b2
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_UNDER_MAINTENANCE_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5382e06-dbdd-4c04-8c76-ffe32468d9e2
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dad94a33-260a-4269-9b74-fe88fee0c62a
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TRANSFERRED_FROM_PROJECT_#
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c432f8c6-fbdc-4822-8699-63ea2d793a56
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 866eb911-f93f-42a6-afc4-c36ac5895b56
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_CONSTRUCTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19ebe882-9576-49d1-b608-8d5d4edaa5bc
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29bd830b-41af-43e2-b4da-bc66a128cd48
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ec3afe0-e2a4-4fb0-9746-a69f1924aabd
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74d4752d-f0b2-4bfd-a509-78bf0c379cae
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 053522e3-e565-4e5c-b234-4c6c99142822
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 907640c4-e1b6-4789-9f96-7381556ce514
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_STYLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a27994d4-5c07-4150-9232-73eee0540c50
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c08d3e1-742b-45bf-9d40-bf17d1878ef0
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: VISUAL_FREQUENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1af7a8e-8679-4585-9b5f-ba55583b2c23
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10757450-b5b0-49b0-8407-53b21a91b325
          stepCounter: fba952f9-d30d-4dce-8c6e-1252050cb1c0
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: OPS_WORK_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7037f99f-563d-4aeb-aa16-cd240e680af9
                stepCounter: 9c872515-9b64-4554-9114-31dcc24267e7
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_PROJECT_CLASSES_UNIQUE
        join:
          joinCondition: FROM {{ ref('USG_STG_MASTER', 'STG_PROJECT_CLASSES_UNIQUE') }} "STG_PROJECT_CLASSES_UNIQUE"
        name: STG_PROJECT_CLASSES
        noLinkRefs: []
  name: STG_PROJECT_CLASSES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
