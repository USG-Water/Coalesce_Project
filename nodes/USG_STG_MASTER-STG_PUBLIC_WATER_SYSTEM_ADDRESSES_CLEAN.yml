fileVersion: 1
id: da37c875-66c1-479e-9035-ec361dda5897
name: STG_PUBLIC_WATER_SYSTEM_ADDRESSES_CLEAN
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97ed03e9-70f6-4eee-8bfa-eb0d5d12d5ca
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: PWSID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09cbec11-433a-4db4-b0be-69503ae8b02b
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a98e29b-6e60-41c4-a181-efac5f3b00da
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ADDRESS_LINE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1abd15e6-0b23-4a8e-aa0d-177cb560a4cc
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b08ef7da-0276-4db5-acbc-3c8d84031eb2
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ADDRESS_LINE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a188ef71-beb4-4def-8179-6a33e69faa9f
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfb27cab-f75c-4434-bb5a-52340b5dc0d3
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d2786ad-c11f-4724-85a2-b2d0ef376b1e
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: UPPER(COALESCE("STG_US_ZIPCODE_POINTS"."CITY", "STG_PUBLIC_WATER_SYSTEM_ADDRESSES"."CITY_NAME"))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 666e4859-f728-4144-b68a-a49ad2b14682
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c13475a-7e3f-48a4-9677-fd03b7484ee0
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91115c02-8111-4941-b757-af987fcebc0d
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: POSTAL_PLUS_4_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55078ba0-599c-46e8-8aea-ae5fa987f66e
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f864a3ea-7de0-49da-a9c6-f270ae9eb1ec
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: COUNTY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e039c8b-9264-4495-8858-f4ab1bb0b70f
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: UPPER(COALESCE("STG_US_ZIPCODE_POINTS"."COUNTY", "STG_PUBLIC_WATER_SYSTEM_ADDRESSES"."COUNTY_NAME"))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 765d5e5f-d2d6-4243-9144-9ba4f25fe09f
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: STATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5dcae56-62ee-41c1-907f-3b13f455bac7
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: UPPER(COALESCE("STG_US_ZIPCODE_POINTS"."STATE", "STG_PUBLIC_WATER_SYSTEM_ADDRESSES"."STATE_CODE"))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d0d061b-89c7-4d3f-8b41-ee6185849a6e
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18218ffa-622b-4817-93dc-6c50879df98b
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cc37ba3-4e87-4e90-96c3-4c9697380977
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: FLOAT
        description: ""
        name: LATITUDE83
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3715652-0b3d-42b2-bba5-0c0fa7441a41
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1c18752-3d3d-4d02-a219-92b8c613955c
          stepCounter: da37c875-66c1-479e-9035-ec361dda5897
        config: {}
        dataType: FLOAT
        description: ""
        name: LONGITUDE83
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7f8306a-e1fb-42db-a02f-11eb0d4656c4
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_PUBLIC_WATER_SYSTEM_ADDRESSES: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
          STG_US_ZIPCODE_POINTS: dbcc38a5-1fe3-42bf-9371-3e522548c470
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_EPA
            nodeName: STG_PUBLIC_WATER_SYSTEM_ADDRESSES
          - locationName: USG_STG_MASTER
            nodeName: STG_US_ZIPCODE_POINTS
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_EPA', 'STG_PUBLIC_WATER_SYSTEM_ADDRESSES') }} "STG_PUBLIC_WATER_SYSTEM_ADDRESSES"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_US_ZIPCODE_POINTS') }} "STG_US_ZIPCODE_POINTS"
                ON "STG_PUBLIC_WATER_SYSTEM_ADDRESSES"."POSTAL_CODE" = "STG_US_ZIPCODE_POINTS"."ZIP_CODE"
        name: STG_PUBLIC_WATER_SYSTEM_ADDRESSES_CLEAN
        noLinkRefs: []
  name: STG_PUBLIC_WATER_SYSTEM_ADDRESSES_CLEAN
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
