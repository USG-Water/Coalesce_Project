fileVersion: 1
id: 27cb409a-bc10-4632-83a6-a146641fc090
name: STG_PROJECT_CUSTOMERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fd1d846-de97-473a-b726-0973b958d06c
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROJECT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3baee4cd-f242-402e-a0c6-c7ec1978a0ed
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."PROJECT_ID",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."PROJECT_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f757bf0-1d89-4bec-a6e7-33bc4c020d0b
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROJECT_PARTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fb54a50-325f-4157-bd76-68f9f658899f
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."PROJECT_PARTY_ID",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."PROJECT_PARTY_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90d698c9-e4be-48bb-8e1f-0cac4b4dbc03
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53fa8969-0028-48da-8788-d18858d99786
                stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
            transform: |-
              MAX_BY(
                  "STG_ACCOUNT_KEYS"."ACCOUNT_ID",
                  CASE 
                      WHEN "STG_ACCOUNT_KEYS"."ACCOUNT_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87a6fbae-6789-4568-9179-2900fff4606d
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR
        description: ""
        name: BILL_TO_ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              MAX_BY(
                  "STG_ACCOUNT_KEYS_BILL_TO"."ACCOUNT_ID",
                  CASE 
                      WHEN "STG_ACCOUNT_KEYS_BILL_TO"."ACCOUNT_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39858e56-7a95-40d9-824e-286ad86eee44
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR
        description: ""
        name: SHIP_TO_ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53fa8969-0028-48da-8788-d18858d99786
                stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
            transform: |-
              MAX_BY(
                  "STG_ACCOUNT_KEYS_SHIP_TO"."ACCOUNT_ID",
                  CASE 
                      WHEN "STG_ACCOUNT_KEYS_SHIP_TO"."ACCOUNT_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ed378d2-e34c-4889-8520-f120eadea042
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64b3e9bc-c921-4c29-9010-3db40a2544ce
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."CUSTOMER_ID",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."CUSTOMER_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11d66b23-3e2b-4cf3-a37f-d80926bf8b34
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_BILL_TO_CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34484362-e6cc-4a58-ba42-1d70766c0120
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."BILL_TO_CUSTOMER_ID",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."BILL_TO_CUSTOMER_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a7565b0-47e1-4987-9ef9-2fdbb5e46c39
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_SHIP_TO_CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bfd7ce0-deb9-4d39-a003-51eeff7bbd3b
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."SHIP_TO_CUSTOMER_ID",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."SHIP_TO_CUSTOMER_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1e87134-5fef-4dd2-bef8-e5926d3b3847
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_BILL_TO_ADDRESS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 800fd6f5-3672-4d61-b2dd-9bebdf2f37dc
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."BILL_TO_ADDRESS_ID",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."BILL_TO_ADDRESS_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2687b46f-0398-4da3-9df4-a8a37e26b5dd
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_SHIP_TO_ADDRESS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 122b32c0-05e1-40c1-a9cf-6dec43d05530
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."SHIP_TO_ADDRESS_ID",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."SHIP_TO_ADDRESS_ID" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e38c4a1-2c13-409d-be96-040b926f4f43
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: NUMBER(7,4)
        description: ""
        name: CUSTOMER_BILL_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a00340b-529c-4b4d-8a21-bf68d21486dd
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."CUSTOMER_BILL_SPLIT",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."CUSTOMER_BILL_SPLIT" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8ab63c6-d524-4c6c-b525-58028bac2e23
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: INV_CURRENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0273c05-f0b1-4676-8690-e0aeff5960f1
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."INV_CURRENCY_CODE",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."INV_CURRENCY_CODE" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c5b2bc3-78f8-483f-9386-8f5329b3347b
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: INV_RATE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb3fdd29-1df4-4721-8739-b57a6f0ba7e2
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."INV_RATE_TYPE",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."INV_RATE_TYPE" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b88b7f7-e1a8-4c13-b1bf-1fad49716493
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: ALLOW_INV_USER_RATE_TYPE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 846c1b0c-74cb-4fae-b048-45d194709fdb
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."ALLOW_INV_USER_RATE_TYPE_FLAG",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."ALLOW_INV_USER_RATE_TYPE_FLAG" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55123183-2d62-42fd-b123-bc3d5ffb0349
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: BILL_ANOTHER_PROJECT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b856b77-d465-4079-bdb5-14612c741008
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."BILL_ANOTHER_PROJECT_FLAG",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."BILL_ANOTHER_PROJECT_FLAG" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9fabb1e-c7fa-4705-9a35-5887b77f846b
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: DEFAULT_TOP_TASK_CUST_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 187f9cba-807c-4025-aed4-3d79ea7cbd53
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."DEFAULT_TOP_TASK_CUST_FLAG",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."DEFAULT_TOP_TASK_CUST_FLAG" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fd2adb4-ee5a-40cd-89fa-4398c07833f5
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CREATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d1bb070-9780-47ea-9631-825436847aea
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."CREATION_DATE",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."CREATION_DATE" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 415753ad-a469-434d-bec8-64e9a8bc1a1e
          stepCounter: 27cb409a-bc10-4632-83a6-a146641fc090
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: LAST_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6403589b-2a0b-4e62-8b3d-826b9395249f
                stepCounter: bbea7a15-f86b-41bf-89b9-5889375e37a5
            transform: |-
              MAX_BY(
                  "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE",
                  CASE 
                      WHEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" IS NOT NULL 
                      THEN "STG_EBS_PROJECT_CUSTOMERS"."LAST_UPDATE_DATE" 
                  END
              )
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_ACCOUNT_KEYS: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
          STG_ACCOUNT_KEYS_BILL_TO: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
          STG_ACCOUNT_KEYS_SHIP_TO: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
          STG_EBS_PROJECT_CUSTOMERS: bbea7a15-f86b-41bf-89b9-5889375e37a5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_ACCOUNT_KEYS
          - locationName: USG_STG_ORACLE_EBS
            nodeName: STG_EBS_PROJECT_CUSTOMERS
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_ORACLE_EBS', 'STG_EBS_PROJECT_CUSTOMERS') }} "STG_EBS_PROJECT_CUSTOMERS"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_ACCOUNT_KEYS') }} "STG_ACCOUNT_KEYS"
                ON "STG_EBS_PROJECT_CUSTOMERS"."CUSTOMER_ID" = "STG_ACCOUNT_KEYS"."EBS_CUSTOMER_ID"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_ACCOUNT_KEYS') }} "STG_ACCOUNT_KEYS_BILL_TO"
                ON "STG_EBS_PROJECT_CUSTOMERS"."BILL_TO_CUSTOMER_ID" = "STG_ACCOUNT_KEYS_BILL_TO"."EBS_CUSTOMER_ID"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_ACCOUNT_KEYS') }} "STG_ACCOUNT_KEYS_SHIP_TO"
                ON "STG_EBS_PROJECT_CUSTOMERS"."SHIP_TO_CUSTOMER_ID" = "STG_ACCOUNT_KEYS_SHIP_TO"."EBS_CUSTOMER_ID"
            GROUP BY "STG_EBS_PROJECT_CUSTOMERS"."PROJECT_ID", "STG_ACCOUNT_KEYS"."ACCOUNT_ID"
        name: STG_PROJECT_CUSTOMERS
        noLinkRefs: []
  name: STG_PROJECT_CUSTOMERS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
