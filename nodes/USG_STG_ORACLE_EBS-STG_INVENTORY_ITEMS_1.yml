fileVersion: 1
id: 259425f4-ea17-4c4b-884f-cac3498470fc
name: STG_INVENTORY_ITEMS_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_ORACLE_EBS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68e721a9-f339-4349-8e7c-649e358db66e
          stepCounter: 259425f4-ea17-4c4b-884f-cac3498470fc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: INVENTORY_ITEM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c96fd37d-5630-4b0b-9f13-c6d4bb8680d5
                stepCounter: 67baa290-82ee-421b-8008-6f70746caad7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53224277-e0d4-473c-ad64-e4aef55748ab
          stepCounter: 259425f4-ea17-4c4b-884f-cac3498470fc
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: INVENTORY_ITEM_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27ddc526-1bea-491d-91a1-1c6885d48d3c
                stepCounter: 67baa290-82ee-421b-8008-6f70746caad7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99a10927-3cdf-4e2e-9407-7ddd8c5ad3a9
          stepCounter: 259425f4-ea17-4c4b-884f-cac3498470fc
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: INVENTORY_ITEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4437d080-29cf-4e73-aeff-410727649c99
                stepCounter: 67baa290-82ee-421b-8008-6f70746caad7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eeb9b16-da31-4922-a475-bd3d6759ccfa
          stepCounter: 259425f4-ea17-4c4b-884f-cac3498470fc
        config: {}
        dataType: NUMBER(38,6)
        description: ""
        name: LIST_PRICE_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a266623-709c-41ab-8893-8273eaa566f6
                stepCounter: 67baa290-82ee-421b-8008-6f70746caad7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9628a04e-0784-4a76-b2cd-8a4fe36ee9ab
          stepCounter: 259425f4-ea17-4c4b-884f-cac3498470fc
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: UNIT_OF_MEASURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ad09fe3-6f10-4103-a595-f6f0c6d3fa33
                stepCounter: 67baa290-82ee-421b-8008-6f70746caad7
            transform: |-
              CASE
                WHEN "INVENTORY_ITEMS"."DESCRIPTION" ILIKE '%(SR)%' THEN 'SQF'
                ELSE "INVENTORY_ITEMS"."PRIMARY_UOM_CODE"     -- or "PRIMARY_UNIT_OF_MEASURE" if that's your source
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ef92c61-8ee3-4cd8-941d-61f83baa2b12
          stepCounter: 259425f4-ea17-4c4b-884f-cac3498470fc
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: UNIT_OF_MEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c114e673-0032-4b6e-aca0-7771cc83aa5a
                stepCounter: 67baa290-82ee-421b-8008-6f70746caad7
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          INVENTORY_ITEMS: 67baa290-82ee-421b-8008-6f70746caad7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_RAW_ORACLE_EBS
            nodeName: INVENTORY_ITEMS
        join:
          joinCondition: FROM {{ ref('USG_RAW_ORACLE_EBS', 'INVENTORY_ITEMS') }} "INVENTORY_ITEMS"
        name: STG_INVENTORY_ITEMS_1
        noLinkRefs: []
  name: STG_INVENTORY_ITEMS_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
