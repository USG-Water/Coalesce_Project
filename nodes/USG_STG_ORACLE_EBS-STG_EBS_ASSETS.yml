fileVersion: 1
id: 059ad469-00c4-4bed-8f7e-908f7a2ad948
name: STG_EBS_ASSETS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_ORACLE_EBS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7048277d-9b95-4810-bdc8-e43a112be4b2
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53fa8969-0028-48da-8788-d18858d99786
                stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5391c4dc-1d10-4414-95d0-2066f116870e
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ADDRESS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 408a2ac1-90f8-481d-a1cf-ce645c207151
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e564b53-17a8-4cf3-9021-c46f47a52ce0
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_PARTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04760f06-5fe9-489d-a44e-e9107c499bbb
                stepCounter: f5b804ff-6ba7-471b-87e2-e38f99155375
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c6d314a-6d1c-4d2e-97a0-68322968f3dc
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cbbaef5-923b-474b-8dbf-9cdf2ebcc96d
                stepCounter: 7ff97544-da76-45e1-92bb-18a6ef6cf0b3
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9de8a161-d1f7-4f22-9928-05a95163eed1
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: EBS_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1b0fea4-99a9-420f-87af-61270b6e0bbb
                stepCounter: f5b804ff-6ba7-471b-87e2-e38f99155375
            transform: ""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 972fb5ab-6152-4aed-b54a-59dd87fadad4
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_PARTY_SITE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1039484-4ba1-4644-81dd-1fe2218fd4fd
                stepCounter: f5b804ff-6ba7-471b-87e2-e38f99155375
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dde347d-206d-4125-a08c-febd9a91e734
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_CUSTOMER_SITE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e4c4f7f-781c-44b4-babc-d5b98114c8b9
                stepCounter: 7ff97544-da76-45e1-92bb-18a6ef6cf0b3
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6ef49c62-8fdc-4687-88dc-970f309331cc
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ASSET_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4093a7e1-c50d-440d-a1ee-01bfbfae4abc
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: TRIM(UPPER("STG_ADDRESSES"."ADDRESS_3"))
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: da9a2561-ba3e-49b5-a4f8-a66c99502194
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ASSET_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9a429d7-26aa-4dc0-84b7-be6efcc2879a
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: TRIM(UPPER("STG_ADDRESSES"."ADDRESS_2"))
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449cedd8-c517-4221-809f-e6069448a63a
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: NUMBER
        description: ""
        name: ASSET_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9a429d7-26aa-4dc0-84b7-be6efcc2879a
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: TRY_CAST(REGEXP_REPLACE(REPLACE(SPLIT_PART(TRIM(UPPER("STG_ADDRESSES"."ADDRESS_2")), ' ', 1),'0K','0000'), '[^0-9]', '') AS INT)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b5cc6174-d4be-489d-9f25-24eea9577ff0
          stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: LAST_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 655fdf49-014f-409b-b799-3125f6b99f6c
                stepCounter: f5b804ff-6ba7-471b-87e2-e38f99155375
            transform: ""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_ACCOUNT_KEYS: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
          STG_ADDRESSES: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
          STG_EBS_CUSTOMER_SITES: 1509d3ca-819b-489e-b07c-d9d79f3b52fb
          STG_EBS_PARTY_SITES: 417b4df2-6bfc-42b1-aae4-40bf81f49b71
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_ACCOUNT_KEYS
          - locationName: USG_STG_MASTER
            nodeName: STG_ADDRESSES
          - locationName: USG_STG_ORACLE_EBS
            nodeName: STG_EBS_CUSTOMER_SITES
          - locationName: USG_STG_ORACLE_EBS
            nodeName: STG_EBS_PARTY_SITES
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_ORACLE_EBS', 'STG_EBS_CUSTOMER_SITES') }} "STG_EBS_CUSTOMER_SITES"
            LEFT JOIN {{ ref('USG_STG_ORACLE_EBS', 'STG_EBS_PARTY_SITES') }} "STG_EBS_PARTY_SITES"
                ON "STG_EBS_CUSTOMER_SITES"."PARTY_SITE_ID" = "STG_EBS_PARTY_SITES"."PARTY_SITE_ID"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_ACCOUNT_KEYS') }} "STG_ACCOUNT_KEYS"
                ON "STG_EBS_CUSTOMER_SITES"."CUST_ACCOUNT_ID" = "STG_ACCOUNT_KEYS"."EBS_CUSTOMER_ID"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_ADDRESSES') }} "STG_ADDRESSES"
                ON "STG_EBS_PARTY_SITES"."LOCATION_ID" = "STG_ADDRESSES"."EBS_LOCATION_ID"
        name: STG_EBS_ASSETS
        noLinkRefs: []
  name: STG_EBS_ASSETS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
