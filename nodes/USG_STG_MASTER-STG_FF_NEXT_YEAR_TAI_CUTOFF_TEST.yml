fileVersion: 1
id: af428526-fa91-4432-aecf-5ed886440b93
name: STG_FF_NEXT_YEAR_TAI_CUTOFF_TEST
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2284d42c-4db8-4041-b6f1-def3b7c4567f
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TAI_CUTOFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"TAI_CUTOFF\".\"TAI_SCORE\""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aba1b494-7645-4105-965c-bf89120fd0b4
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROJECT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 582a4742-31cd-40f3-b7de-2c7842849f73
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52650591-4007-4be2-a2e9-a9d9ad20d7e7
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TASK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f817405-ede0-43d7-88e6-c4c6e02465df
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a05d44ab-a802-4891-98d6-c6262d8b2a43
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: VARCHAR
        description: ""
        name: TASK_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5166c07e-15f2-47ba-8abf-70d7c8f26354
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ed67493-cec6-4d16-875c-30d8ba935e88
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: VARCHAR
        description: ""
        name: INTERIOR_OR_EXTERIOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30adbd8e-3c7c-405a-89ae-4098f169ab1b
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4235acb9-0f50-4e0f-864d-39f6cf91e451
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaab4ca7-960e-465f-a433-a821fa0f14a0
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0373f6ca-7129-4ddb-84b7-cfe77d90e1ba
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8a5e23f-f5df-40b9-bc57-ccc7bd4224f3
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcbede68-a32f-47c5-a03b-397c1396b040
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_STYLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05992f4b-f54a-4c54-b2d2-7699e7141212
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59402468-4820-4f44-bdd3-9e1ca8186ebd
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: VARCHAR(30)
        description: ""
        name: TANK_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0520f6a2-e700-42c0-80d1-d2514e21398e
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdb80169-24ab-4222-9ca4-ee49be839fdf
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: VARCHAR(240)
        description: ""
        name: PAINT_CONDITION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57b9b39d-c161-478f-9e63-3c285306d1c1
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29cfacb9-ff76-4955-88af-0c5a43eb9922
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: NUMBER(38,5)
        description: ""
        name: SQUARE_FOOTAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f2ac8d2-d35b-4ce7-ab04-077bd32ac827
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e95862b-1f06-4f27-b8a5-8fecc9f3881f
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        description: ""
        name: INITIAL_COST_PER_SQFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a46b24cb-33e6-4525-8403-5decb0d9f7c0
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be9a5b98-0fd7-4d91-913c-f4702a4d69df
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        description: ""
        name: INITIAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ab1b62-13ca-4f5d-a176-ace020d3d41c
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c6b4cf0-d0aa-456e-99b1-6affdd9e01d1
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        description: ""
        name: TAI_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e05d616f-4cf2-4b42-875d-08bc199572af
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a440c36c-7ae5-4ea6-bc38-a7de1064ed4a
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: NUMBER
        description: ""
        name: ACCOUNT_ASSET_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b9d5b9-fd71-4a1b-baed-d21be0653e9f
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43b4c766-4dad-4c93-8369-ae48eb876b10
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        description: ""
        name: AVG_BILLINGS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f63c9049-11e0-472a-a8bd-aba982891d00
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e3eb2bb-c5a2-43c6-8fb9-bc964738e1f6
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        description: ""
        name: AVG_ANNUAL_LOG_DEGREDATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 152f87f1-2ec3-48b2-a9ff-a319f6a12e8c
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56c52480-84e5-4622-8b9d-c31e30009ca1
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        description: ""
        name: AVG_ANNUAL_PCT_DEGREDATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19495316-5065-40b5-a6af-6c7a46bc1fb6
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ca065de-7ea2-4772-b4ef-b859f2acfdb2
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        name: COST_BUDGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9846f95-73d4-4875-a8a1-22af905c43f0
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5ed9cb3-7364-4042-9c36-55fed6fcba6c
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: BOOLEAN
        description: ""
        name: COASTAL_TANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ede5d5bb-b9ac-4dca-addc-2e857a152970
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a47a59-452d-4892-a1f9-a0b775e2f4ba
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: BOOLEAN
        description: ""
        name: DATE_CONTRACT_OBLIGATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbc56415-7645-462e-9678-28bb7aff511c
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9299fc8e-560c-4d5f-bfbe-8c1f4881bf9b
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: FLOAT
        description: ""
        name: AVG_CYCLE_LENGTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac98f5b9-9542-40a1-9922-c106fdc5fe01
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73ba4bfd-e3bb-4afb-9835-807ef0302f1f
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: NUMBER
        description: ""
        name: YEARS_SINCE_LAST_COMPLETION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1daa7237-52f7-4852-8241-523a36edf914
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6722845f-b138-45dd-afb5-759e21bbe9df
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: DATE
        description: ""
        name: TAI_ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02fc0703-b158-4697-9fa8-5bede7ad3369
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 976a9402-8601-4363-a930-f164fcd5021e
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: DATE
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8694a72b-5ad7-476e-bbe3-6e68ba94aed9
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16fd0982-3ba0-4a4a-9caa-1e4ad4dee503
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: NUMBER
        description: ""
        name: START_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e6eaa87-6f93-4d24-83b1-54c21b75c694
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60e8475c-8a8a-4ed0-8de5-3d674270c5ee
          stepCounter: af428526-fa91-4432-aecf-5ed886440b93
        config: {}
        dataType: DATE
        description: ""
        name: LAST_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca79b997-ea3c-4589-a08d-9ad672b41be2
                stepCounter: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_FF_FORECAST_PARAMETERS: db610cdc-c7a1-4f5a-a61f-f004b61a1164
          STG_FF_FUTURE_FORECAST_METRICS: 839bb6d5-fe2f-4650-a4b5-9fd72f01bd80
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_FF_FORECAST_PARAMETERS
          - locationName: USG_STG_MASTER
            nodeName: STG_FF_FUTURE_FORECAST_METRICS
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_MASTER', 'STG_FF_FUTURE_FORECAST_METRICS') }} "STG_FF_FUTURE_FORECAST_METRICS"
            CROSS JOIN (
                SELECT 1.5 + (SEQ4() * 0.1) AS TAI_SCORE
                FROM TABLE(GENERATOR(ROWCOUNT => 26))
            ) AS "TAI_CUTOFF"
            CROSS JOIN {{ ref('USG_STG_MASTER', 'STG_FF_FORECAST_PARAMETERS') }} AS "STG_FF_FORECAST_PARAMETERS"
            WHERE ("STG_FF_FUTURE_FORECAST_METRICS"."TAI_SCORE" <= "TAI_CUTOFF"."TAI_SCORE" OR "STG_FF_FUTURE_FORECAST_METRICS"."DATE_CONTRACT_OBLIGATION" = TRUE)
                AND STG_FF_FUTURE_FORECAST_METRICS.START_YEAR <= (
                    (SELECT MIN(START_YEAR) FROM {{ ref('USG_STG_MASTER', 'STG_FF_FUTURE_FORECAST_METRICS') }})
                    + STG_FF_FORECAST_PARAMETERS.PRM_FORECAST_YEARS - 1
                )
            ORDER BY "TAI_CUTOFF"."TAI_SCORE"
                     , "STG_FF_FUTURE_FORECAST_METRICS"."DATE_CONTRACT_OBLIGATION" DESC
                     , "STG_FF_FUTURE_FORECAST_METRICS"."TAI_SCORE"
        name: STG_FF_NEXT_YEAR_TAI_CUTOFF_TEST
        noLinkRefs: []
  name: STG_FF_NEXT_YEAR_TAI_CUTOFF_TEST
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
