fileVersion: 1
id: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
name: STG_MERGE_ADDRESSES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Create a union on all systems with addresses
  isMultisource: true
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 888b03d8-d496-4ccb-be69-4a2960128138
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: OSC_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd7e3e7b-d136-4d99-8d77-49574b03af08
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0db23a1-fbba-4622-8516-5581a3b74f7f
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: HUBSPOT_COMPANY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: 0ca5d12b-0320-47f7-b92a-aca3b3b3aa39
                stepCounter: a485b708-19e1-449a-bb15-89f3638f951e
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27302635-ac2a-483c-828c-6e6a959d1c68
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: 58fbdf0a-86dd-4c92-97c8-0eda5130470c
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1098dfb1-b35e-4332-87dc-556d6f96a23b
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR
        description: ""
        name: EPA_PWSID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: 09cbec11-433a-4db4-b0be-69503ae8b02b
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b1e0895-c885-46de-8d42-28bc52a53d6e
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(150)
        description: ""
        name: EBS_PWSID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: c95b0815-6734-43b4-9c9a-291bbff213b3
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b141943-7028-4716-8a71-a325a075475d
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76dc78c7-7062-4395-8ead-4b6214b80f6e
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences:
              - columnCounter: 6789f6e7-b9a9-4af9-b180-cfdcfdfe8fa0
                stepCounter: a485b708-19e1-449a-bb15-89f3638f951e
            transform: ""
          - columnReferences:
              - columnCounter: 6696a6d5-0ecf-42ae-a271-5843566b8a60
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences:
              - columnCounter: 1abd15e6-0b23-4a8e-aa0d-177cb560a4cc
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7e32c26-1785-4a8d-b85e-21a0acf43fdd
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b3eb4f2-a16a-4ca2-b33a-8fe64ea075a7
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences:
              - columnCounter: 0dd98d7a-31df-4c78-9897-52c6fc7e2b91
                stepCounter: a485b708-19e1-449a-bb15-89f3638f951e
            transform: ""
          - columnReferences:
              - columnCounter: 3aa32bae-2ac9-454a-86b3-101765bed310
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences:
              - columnCounter: a188ef71-beb4-4def-8179-6a33e69faa9f
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3fb0720-3b36-4fd7-be59-adc7f1dce5d7
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60218d08-4318-4382-b572-245219b0f11e
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: 8dc62c79-aac0-4f77-8b9d-d00c9b09810b
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 039cbe5c-419b-4db1-a798-deab49107832
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2fbf03f-66c3-4cdb-b097-9629ee7ebb47
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: 814f56bc-c3d3-4fc4-997a-146bbfb3f791
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c8f9aa5-1089-416e-b9c3-7814d6d64e40
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(16384)
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82eb7d42-1c79-4203-b02d-08899009afcc
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences:
              - columnCounter: 312eb810-595c-408a-a194-429c3cc92046
                stepCounter: a485b708-19e1-449a-bb15-89f3638f951e
            transform: ""
          - columnReferences:
              - columnCounter: 874caf52-cb08-4ae9-9248-292f0ee9f84b
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences:
              - columnCounter: 3d2786ad-c11f-4724-85a2-b2d0ef376b1e
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35f6c50f-234d-4317-b4cd-a25ed494087e
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18ceeac7-1bad-46e4-82bd-321080a362c4
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: e95b499b-ea0f-46ea-a5a8-2ab533cca407
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences:
              - columnCounter: 0c13475a-7e3f-48a4-9677-fd03b7484ee0
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5270730f-d62b-41d9-b336-b995ea4b1217
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: POSTAL_PLUS_4_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9837bcd2-ed13-434b-ab8e-03f0dcbf4a13
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: 55078ba0-599c-46e8-8aea-ae5fa987f66e
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35ae2f0e-3985-45bd-82ac-99d7facb848c
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc57cca5-6739-47be-8121-46cbc7fb3035
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: 1d325a42-c748-4a2a-b6f8-0bf81251159e
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences:
              - columnCounter: 2e039c8b-9264-4495-8858-f4ab1bb0b70f
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38162e9e-af27-4767-9e3f-5af489c3351a
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 532f8ce4-f446-440d-8595-837dedc0d50d
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: b8273a6d-1af1-4c9e-a5b2-a5269b8ebb45
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d28d072-a080-4384-9e71-9501c4e9faef
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fcb260d-22ce-4afb-a773-06767ba09608
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences:
              - columnCounter: 93a738cb-03a3-481e-89f2-88dd3227539f
                stepCounter: a485b708-19e1-449a-bb15-89f3638f951e
            transform: ""
          - columnReferences:
              - columnCounter: 535c866f-1ec0-4126-994c-18c41a273867
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences:
              - columnCounter: e5dcae56-62ee-41c1-907f-3b13f455bac7
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0be8b88e-fbd7-42be-909f-3a5e73f29e34
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60836583-aa44-41a2-aa12-5fb7e53c888d
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences:
              - columnCounter: 2de02726-9941-4b0c-a504-7c385770b1ed
                stepCounter: a485b708-19e1-449a-bb15-89f3638f951e
            transform: ""
          - columnReferences:
              - columnCounter: 2e8d5f7f-3b08-437c-a71b-2d99c84c3ac5
                stepCounter: 40523822-d977-4638-a60d-78be58fa05b5
            transform: ""
          - columnReferences:
              - columnCounter: 18218ffa-622b-4817-93dc-6c50879df98b
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f82245db-ca2b-4dbd-86d9-a1b614f6d027
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: FLOAT
        description: ""
        name: LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8df1cec-3654-43bf-82aa-e1ddc4e23070
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: c3715652-0b3d-42b2-bba5-0c0fa7441a41
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daf04166-5755-475a-8918-1babb61c9f65
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: FLOAT
        description: ""
        name: LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ab2dff8-1fff-492c-8544-2007c7bdb611
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences:
              - columnCounter: e7f8306a-e1fb-42db-a02f-11eb0d4656c4
                stepCounter: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c68b94b7-a31b-4c60-a615-9bc1c577b22d
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: BOOLEAN
        description: ""
        name: INTERNAL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34beb18e-7d51-4bfd-a36b-85aa83922516
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d36bb66-89ae-4644-a598-58739efbfea4
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: BOOLEAN
        description: ""
        name: ACTIVE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05ea025a-3c4d-47ea-ae1e-4d7dd21270f0
                stepCounter: bcd98b5e-be38-4635-967b-89574c0c5ec0
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: edb9a8f9-21ee-41ed-81be-de465c37d8fc
          stepCounter: 26332af8-2ceb-4e52-a3d1-d9a6f6046f38
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'OSC'"
          - columnReferences: []
            transform: "'HubSpot'"
          - columnReferences: []
            transform: "'EBS'"
          - columnReferences: []
            transform: "'EPA'"
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_ORACLE_SALES_CLOUD
            nodeName: STG_OSC_LOCATION
        join:
          joinCondition: FROM {{ ref('USG_STG_ORACLE_SALES_CLOUD', 'STG_OSC_LOCATION') }} "STG_OSC_LOCATION"
        name: STG_OSC_LOCATION
        noLinkRefs: []
      - aliases:
          STG_HUBSPOT_COMPANIES: a485b708-19e1-449a-bb15-89f3638f951e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_HUBSPOT
            nodeName: STG_HUBSPOT_COMPANIES
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_HUBSPOT', 'STG_HUBSPOT_COMPANIES') }} "STG_HUBSPOT_COMPANIES"
            WHERE "STG_HUBSPOT_COMPANIES"."STREET_ADDRESS" IS NOT NULL
            AND "STG_HUBSPOT_COMPANIES"."STREET_ADDRESS_2" IS NOT NULL
            AND "STG_HUBSPOT_COMPANIES"."CITY" IS NOT NULL
            AND "STG_HUBSPOT_COMPANIES"."STATE" IS NOT NULL
            AND "STG_HUBSPOT_COMPANIES"."COUNTRY" IS NOT NULL
        name: STG_HUBSPOT_COMPANIES
        noLinkRefs: []
      - aliases:
          STG_EBS_LOCATIONS: 579ccb1a-8921-482f-83de-2c6da25c326f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_ORACLE_EBS
            nodeName: STG_EBS_LOCATIONS
        join:
          joinCondition: FROM {{ ref('USG_STG_ORACLE_EBS', 'STG_EBS_LOCATIONS') }} "STG_EBS_LOCATIONS"
        name: STG_EBS_LOCATIONS
        noLinkRefs: []
      - aliases:
          STG_PUBLIC_WATER_SYSTEM_ADDRESSES: 72cc47b8-11e4-4998-9f65-f7ee1eaecbb6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_EPA
            nodeName: STG_PUBLIC_WATER_SYSTEM_ADDRESSES
        join:
          joinCondition: FROM {{ ref('USG_STG_EPA', 'STG_PUBLIC_WATER_SYSTEM_ADDRESSES') }} "STG_PUBLIC_WATER_SYSTEM_ADDRESSES"
        name: STG_PUBLIC_WATER_SYSTEM_ADDRESSES
        noLinkRefs: []
  name: STG_MERGE_ADDRESSES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
