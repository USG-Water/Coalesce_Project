fileVersion: 1
id: f76bc498-9a03-4e52-95e0-39feab0bb8cc
name: STG_ADDRESSES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40352e3b-74a5-468d-af4e-1736a9c5f6a2
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR
        description: ""
        name: ADDRESS_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 408a2ac1-90f8-481d-a1cf-ce645c207151
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca4b7537-f6b1-4631-bca7-d50314e82074
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: OSC_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0938549-07fd-4991-8f76-da69f5d79442
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 585e58af-0c11-456e-a868-628e5bfd639c
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: HUBSPOT_COMPANY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db504681-c069-4347-b750-1e2b46633bf0
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4b05611-d1a2-4374-b5e7-a41118c64bdc
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b472df-679d-4aba-8d2a-3862c7fa08db
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0022ad84-d45c-441b-94f0-0cd717541e24
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR
        description: ""
        name: EPA_PWSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab2b39be-74ab-4b27-b9e3-dd9c33798819
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2642394a-5872-489e-95e4-d8baffe24e00
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(150)
        description: ""
        name: EBS_PWSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a479fc3a-1284-4b64-a334-303e3b010da0
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b632e4d-95cc-47dc-9841-2c6ad6cf34af
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: FNC_FIPS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 158672eb-5385-447e-a276-37e1d3fb0fe2
                stepCounter: 540c95c4-d5b5-41c2-9d47-55e8d100fd34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dbf8987-db51-43a0-b1d9-d25587083c86
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b9fafe8-04d4-4ce9-82ad-4587559c0c1e
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f68feb2-d018-4896-acfc-416673f23ab7
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9a429d7-26aa-4dc0-84b7-be6efcc2879a
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4497693-a1bb-4e60-b878-07e0cccfb6c5
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4093a7e1-c50d-440d-a1ee-01bfbfae4abc
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4c6e215-88cf-4fa3-b5a2-93ff16c3c167
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ADDRESS_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 800ea988-accc-4767-ad01-7c56a4b011bd
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d090e7c-5de3-446e-bcd7-80529707d28c
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(16384)
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f06ba3a5-2051-4d0b-be7f-994a9c3a90e8
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8c942cd-115c-42cd-9488-be9a8544dafb
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3b941b1-a62c-4e64-b2c9-02c41482148e
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e9792b0-1858-4d92-9422-ddfe42bdb8aa
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f77a6272-cff1-4491-9299-e7df96f73e00
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f03866fb-83fb-46f7-aa9f-441808f29f2d
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51796ab6-300a-487d-adf6-1e0994176734
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24098fc6-69d9-4e4d-a485-93a5d3d05957
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a222f765-48eb-4d95-ab9d-ed5deb70eef6
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a2b9d93-ae2a-426d-be02-d7c1c503e85a
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2e2edbf-8693-4dfb-b9c4-c320f48bd6d3
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90704328-53cf-45d6-a8fd-f184ed48a7e3
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: FLOAT
        description: ""
        name: LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca2de85a-a297-41d0-8982-97b1ce5776e7
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: COALESCE("STG_ADDRESSES_CLEAN"."LATITUDE", "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"."LATITUDE", "STG_FNC_LOCATIONS"."LATITUDE", "STG_US_ZIPCODE_POINTS"."LATITUDE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d70ce1b-415c-4191-807d-e4c13dc5e825
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: FLOAT
        description: ""
        name: LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3eba6aef-9742-4331-865b-4383d58549a8
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: COALESCE("STG_ADDRESSES_CLEAN"."LONGITUDE", "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"."LONGITUDE", "STG_FNC_LOCATIONS"."LONGITUDE", "STG_US_ZIPCODE_POINTS"."LONGITUDE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 673aaef9-9b96-4f63-9912-d1f62503db64
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR
        description: ""
        name: POINT_GRANULARITY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE
                  WHEN "STG_ADDRESSES_CLEAN"."LONGITUDE" IS NOT NULL THEN 'Address'
                  WHEN "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"."LONGITUDE" IS NOT NULL THEN 'Address'
                  WHEN "STG_FNC_LOCATIONS"."LONGITUDE" IS NOT NULL THEN 'Municipality'
                  WHEN "STG_US_ZIPCODE_POINTS"."LONGITUDE" IS NOT NULL THEN 'Zipcode'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5472b9ec-9584-4924-80ca-fe8b89348655
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: BOOLEAN
        description: ""
        name: INTERNAL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a90a9622-cef1-44be-8cc3-7f7099e1afa3
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a4d44ce-2f07-43df-8a78-d8c27990bc43
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: BOOLEAN
        description: ""
        name: ACTIVE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4865d7d6-4569-4f14-9510-647f21fa5c9e
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f2cba81-2bca-4c21-aa3c-a6ea89a03175
          stepCounter: f76bc498-9a03-4e52-95e0-39feab0bb8cc
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f770844-63a8-4aee-9a4d-a02c4be73f47
                stepCounter: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_ADDRESSES_CLEAN: c24c0ed3-36ea-41c5-bfc1-ae66163409b6
          STG_ASSET_US_CENSUS_ADDRESS_LOOKUP: 4dbcab20-374a-46b3-b4c7-8879ca100fbf
          STG_FNC_LOCATIONS: 540c95c4-d5b5-41c2-9d47-55e8d100fd34
          STG_US_ZIPCODE_POINTS: dbcc38a5-1fe3-42bf-9371-3e522548c470
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_FISCAL_NOTE_CURATE
            nodeName: STG_FNC_LOCATIONS
          - locationName: USG_STG_MASTER
            nodeName: STG_ADDRESSES_CLEAN
          - locationName: USG_STG_MASTER
            nodeName: STG_ASSET_US_CENSUS_ADDRESS_LOOKUP
          - locationName: USG_STG_MASTER
            nodeName: STG_US_ZIPCODE_POINTS
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_MASTER', 'STG_ADDRESSES_CLEAN') }} "STG_ADDRESSES_CLEAN"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_US_ZIPCODE_POINTS') }} "STG_US_ZIPCODE_POINTS"
                ON "STG_ADDRESSES_CLEAN"."STATE" = "STG_US_ZIPCODE_POINTS"."STATE"
                AND "STG_ADDRESSES_CLEAN"."POSTAL_CODE" = "STG_US_ZIPCODE_POINTS"."ZIP_CODE"
            LEFT JOIN {{ ref('USG_STG_FISCAL_NOTE_CURATE', 'STG_FNC_LOCATIONS') }} "STG_FNC_LOCATIONS"
                ON "STG_ADDRESSES_CLEAN"."CITY" = "STG_FNC_LOCATIONS"."LOCATION"
                AND "STG_ADDRESSES_CLEAN"."STATE" = "STG_FNC_LOCATIONS"."STATE"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_ASSET_US_CENSUS_ADDRESS_LOOKUP') }} "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"
                ON "STG_ADDRESSES_CLEAN"."ADDRESS_1" = "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"."ADDRESS_1"
                AND "STG_ADDRESSES_CLEAN"."CITY" = "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"."CITY"
                AND "STG_ADDRESSES_CLEAN"."POSTAL_CODE" = "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"."POSTAL_CODE"
                AND "STG_ADDRESSES_CLEAN"."STATE" = "STG_ASSET_US_CENSUS_ADDRESS_LOOKUP"."STATE"
        name: STG_ADDRESSES
        noLinkRefs: []
  name: STG_ADDRESSES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
