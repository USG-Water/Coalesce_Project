fileVersion: 1
id: 072caf50-30ee-4628-8f1c-6eb2fbe71880
name: STG_TASKS_W_TUM_FLAG
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Join flag that pre-processes if a task is an eligible tank under management
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41fc4c8b-8d25-4329-a716-d0cfdd719130
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TASK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dd3bf73-8240-429f-9da2-1d192f333751
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b00e76e0-a0fb-4661-8d1d-bfd257b52b79
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: TASK_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be3b294a-da2a-4322-baf9-77fa733f42d9
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df320b88-0ba2-4080-9a71-bd80631f3b75
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TOP_TASK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f53e7176-2375-4034-989b-9358d26bbe9a
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8b0b58b-06fd-40aa-92cb-e1a2cea478ac
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PARENT_TASK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d02f5458-8c1d-4f16-b8ed-9adc2536491a
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05fa7a14-2712-4655-b0ae-04d7cd0c1bd5
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROJECT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ad209d-758a-440b-8715-59bc1a204c20
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfd65178-e847-4038-b2b2-de79008da121
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SERVICE_REQUEST_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c29752e3-194d-44ea-908e-5c11515fd054
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b571f1c-6925-47fb-bc27-48151357b855
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CARRYING_OUT_ORGANIZATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13ebe6a4-abd2-4fed-9c15-5d1817d28ada
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e82a5442-bd34-4443-88ac-69e868c50f70
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: PM_TASK_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4612145b-a4e3-4dd1-b3a5-5044f59bb8c1
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 718bdfb7-d6e2-4da4-b411-41a4f7ce6f53
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: TASK_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab291217-a776-450c-861e-d1c915ae3887
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad9e262b-257b-48a2-ac9f-19b3a7eeb057
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: TASK_SHORT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0339d2b9-97ca-4e8e-a745-049d0d9eb678
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3ea819-4173-4ebf-8301-42a422dac07b
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: CONTRACT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f0746df-5845-4d8d-958f-e56b2b6ebee1
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e6051b6-b1b1-4590-8d90-9e66c4336d70
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: SERVICE_LINE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b237f0f2-8cf2-45b2-b848-028b99cc6eeb
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f3c9a7e-3c18-46f4-a154-38d3eab6623c
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PRODUCT_LINE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 049c9a84-1e0c-4b2f-9dda-2bd9df07b6f8
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b542565b-f64f-4ef8-ad20-a399147779b6
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: TASK_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c67d8668-6929-418e-80c4-2f7092ff929a
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cc4c9f3-3545-4348-9f30-832eac178d1d
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: TASK_NAME_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0259be0a-a5f8-42ca-91b9-02c7425eb87c
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21993ce4-fb11-48e5-b080-015241a0c64a
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6d51435-3630-4aae-854a-9cd0fef411dc
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d5614b-7e53-4593-961b-6b9607b71047
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: RENOVATION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d3a033c-825b-44d6-b4ba-fa058a28a716
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96e37844-e063-4243-88bc-b7a8788165e1
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: INTERIOR_OR_EXTERIOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e746fa65-6d63-4cb4-8ede-34885420984d
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a8aa62-e27c-4456-9cb1-a876cafcd3f6
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: COMMISSION_OR_BILL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348933e-b224-4936-98e1-df924f4106ea
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bd75c1e-0571-4055-823b-3ed740b50f2e
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: BILL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b3e848d-bf08-41a7-82db-e15b9e9891ab
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4de8c034-059d-4637-8473-939a245d875c
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(4)
        description: ""
        name: COMMISSION_PREFIX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46eb7f22-f984-4c73-95bb-4661fa4dfd4b
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f7de66-8e51-4d3e-a7c9-8c69adae982c
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: SERVICE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ac8f867-2127-47ab-a6da-b4ec1a61c8f1
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2ed4bd1-6d23-41aa-961d-ab536699827f
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: WBS_LEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b88c3ddf-0973-4170-96b8-890034ec0f3a
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6668e444-4056-4f05-8eac-051d86b689cb
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(240)
        description: ""
        name: PAINT_CONDITION_EVALUATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fce18940-a932-45ae-a2ba-05a312ce3451
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d203ba9-3e80-441d-af5f-f7418254d0e1
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR(240)
        description: ""
        name: PAINT_CONDITION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49885997-f3a6-4bb5-91fe-5a862bfeed57
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db8ce939-86d9-4f72-b535-739669e359ad
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: REVENUE_ACCRUAL_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f129424c-1ad0-4853-b889-18abaed7d41d
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb4b93ad-64ca-437c-96c0-52e9182bc489
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: REVENUE_ACCUM_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ff003e1-cfa6-407c-b900-81763edc7c09
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac660df8-c9e0-4f02-8660-70ac32d88c49
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,4)
        description: ""
        name: REVENUE_BUDGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78d05763-503a-4c3e-9ca2-aeecd87f1b83
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37c8658d-9aa2-4587-9317-eac0aafe7271
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: VARCHAR
        description: ""
        name: INVOICE_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a58ea6ec-bcb7-42b5-8415-89c7a7850255
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77101205-5933-4ba2-9857-c229d7536de0
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: BOOLEAN
        description: ""
        name: READY_TO_BILL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4513b347-f7af-4415-a9ae-3fe9bd7ab8d5
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c351ce8c-19db-4279-a430-801b0efb317e
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: BOOLEAN
        description: ""
        name: READY_TO_DISTRIBUTE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bdbd2ab-bd9c-4033-a4a0-5057125fa694
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88cc9fd8-1f48-40f3-83e6-54634bcf5aff
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: BOOLEAN
        description: ""
        name: CHARGEABLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2812e37-afe4-42e4-bc77-22afa5a53530
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da065ca5-f1cf-41e7-8859-8de3565e22bd
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: BOOLEAN
        description: ""
        name: BILLABLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04ee4f61-6a0a-43a4-9b06-0f639c1e5668
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b0455a0-79c2-457a-ae6a-6ebe96644d14
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: BOOLEAN
        description: ""
        name: BEFORE_PROJECT_CLOSE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e846963e-df57-45a6-b213-6d6a47434b20
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1721eea9-44d9-47d3-8e8e-7a5b77147270
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: BOOLEAN
        description: ""
        name: ELIGIBLE_TUM_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69531f08-b3b6-4962-b5e0-bd82c1869109
                stepCounter: 51b470a9-98e7-4cef-8b04-c6838d160f23
            transform: COALESCE("STG_ELIGIBLE_TUMS"."TASK_ID", FALSE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648e6fbb-0a6a-4a4c-8b3e-ef97cff0df26
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: BOOLEAN
        description: ""
        name: ADJUSTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52010693-4d27-42dc-92b4-bd4aec41286b
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99b26a34-39b1-45cd-8331-752d40ecc5b5
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: RECORD_VERSION_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afb0f74c-8de9-4542-aedb-5d3347d5d6e1
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 103d09a9-f457-4fa2-bb5d-a21715be4845
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: DATE
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6441ecc5-1bd6-4890-9c70-c366010a6a9c
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ead865b-ba25-40ea-9800-d00a2989ad25
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: DATE
        description: ""
        name: COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a4941c6-4435-49d5-8827-7b50fb120deb
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3c2e4f8-ae44-448a-8995-3b2906b45469
          stepCounter: 072caf50-30ee-4628-8f1c-6eb2fbe71880
        config: {}
        dataType: DATE
        description: ""
        name: LAST_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2166d5a-2a03-48fd-a609-1f28f220de6c
                stepCounter: 413cd36f-e28b-4d12-9785-f06a307f8d64
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_ELIGIBLE_TUMS: 51b470a9-98e7-4cef-8b04-c6838d160f23
          STG_TASKS: 413cd36f-e28b-4d12-9785-f06a307f8d64
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_ELIGIBLE_TUMS
          - locationName: USG_STG_MASTER
            nodeName: STG_TASKS
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_MASTER', 'STG_TASKS') }} "STG_TASKS"
            LEFT JOIN {{ ref('USG_STG_MASTER', 'STG_ELIGIBLE_TUMS') }} "STG_ELIGIBLE_TUMS"
                ON "STG_TASKS"."TASK_ID" = "STG_ELIGIBLE_TUMS"."TASK_ID"
        name: STG_TASKS_W_TUM_FLAG
        noLinkRefs: []
  name: STG_TASKS_W_TUM_FLAG
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
