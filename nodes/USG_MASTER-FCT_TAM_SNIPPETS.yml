fileVersion: 1
id: a3d574fd-a612-4df3-af00-aacfceccfff7
name: FCT_TAM_SNIPPETS
operation:
  config:
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: Joined competitive data "snippets" from both FiscalNote and Citylitics.
  isMultisource: false
  locationName: USG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5067f0fd-6917-48db-95da-9563d984396c
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: FNC_FIPS_CITYLITICS_LEAD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_TAM_SNIPPETS_W_KEYWORDS_FINAL"."FNC_FIPS" IS NULL AND "STG_TAM_SNIPPETS_W_KEYWORDS_FINAL"."CITYLITICS_LEAD_ID" IS NULL THEN NULL
                  ELSE CONCAT(COALESCE("STG_TAM_SNIPPETS_W_KEYWORDS_FINAL"."FNC_FIPS"::VARCHAR, ''), '|', COALESCE("STG_TAM_SNIPPETS_W_KEYWORDS_FINAL"."CITYLITICS_LEAD_ID"::VARCHAR, ''))
              END
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5940359-3553-4e3b-adeb-17f3a9f48570
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: FNC_FIPS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a8f8120-98ee-4ba9-9ac7-251a4b66e70e
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b61c3a40-33af-45e5-a2da-fdae9f66ad8c
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CITYLITICS_LEAD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8341009-9cb1-417b-95a1-a14feccf08a9
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3a10950-06a2-4841-9071-6c8630cb5aaa
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CL_SNIPPET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e7f9769-7c05-4fca-8dea-58a86035eee1
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e82073-ee02-48a6-8db6-ab09810368b3
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: FNC_SNIPPET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5342dfd-49df-469b-971b-41917666119e
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea77e912-748c-4edd-87a2-278acf3fb625
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR
        description: ""
        isBusinessKey: true
        name: SNIPPET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3df5ea5-9ca0-407b-b11a-5039f3f7ab25
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fce35f1f-1501-438d-b859-fbc1bb9e6a6c
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: FNC_SNIPPET_TOPIC_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 718f7bd7-15bb-441c-ae65-ed9200725680
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f58b09f8-6ae0-4f13-94e7-e021cbf8b625
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b49d4a5-daa0-4a73-9513-a8fccc512a56
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aac0ff7-29e4-464d-8187-0f5a048754a1
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: TOPIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42b8e264-3183-4732-a5d8-3788956594ff
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc3c9a0b-176d-4ac5-afee-3f8ed4ba3be9
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR
        description: ""
        name: SNIPPET_URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e443f66-695e-4e7d-93c0-1d9547333952
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bdd489d-2ad2-4715-9025-1f0e89d50309
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR
        description: ""
        name: SNIPPET_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4585b1e3-eac2-4d5e-beaf-853a913d2b93
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 764c02a4-6369-4dd5-bf74-a2554307b8fc
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR
        description: ""
        name: SNIPPET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41b66071-54f5-4ffb-a1f5-32fc76b4ac4a
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fee2afa9-b6a7-4916-89ac-ffd5b7de3992
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: DATE
        description: ""
        name: TS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 670b4de0-53d2-4f4e-aff1-c0795d11aa0a
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be2af969-a538-405d-a587-b66be874c31a
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3edd462f-e391-498c-b77a-4e0e43074570
                stepCounter: 69363db2-a12a-4044-a340-c51990cbb8ba
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d78d6d76-f4a0-4e93-a527-5ad86ca53325
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemCreateDate: true
        name: SYSTEM_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3a5c6c7a-bdb4-4ec7-8cb0-0f25f2577e6c
          stepCounter: a3d574fd-a612-4df3-af00-aacfceccfff7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemUpdateDate: true
        name: SYSTEM_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_TAM_SNIPPETS_W_KEYWORDS_FINAL: 69363db2-a12a-4044-a340-c51990cbb8ba
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_TAM_SNIPPETS_W_KEYWORDS_FINAL
        join:
          joinCondition: FROM {{ ref('USG_STG_MASTER', 'STG_TAM_SNIPPETS_W_KEYWORDS_FINAL') }} "STG_TAM_SNIPPETS_W_KEYWORDS_FINAL"
        name: FCT_TAM_SNIPPETS
        noLinkRefs: []
  name: FCT_TAM_SNIPPETS
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
