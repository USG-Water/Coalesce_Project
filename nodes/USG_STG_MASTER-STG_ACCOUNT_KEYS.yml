fileVersion: 1
id: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
name: STG_ACCOUNT_KEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Create a Account ID that associates all similar accounts among systems
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53fa8969-0028-48da-8788-d18858d99786
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE
                  WHEN "STG_ACCOUNT_CLEAN".NAME IS NOT NULL THEN MD5("STG_ACCOUNT_CLEAN".NAME)
                  ELSE MD5(COALESCE("STG_ACCOUNT_CLEAN"."OSC_PARTY_ID"::VARCHAR, '') || '|' || COALESCE("STG_ACCOUNT_CLEAN"."HUBSPOT_COMPANY_ID"::VARCHAR, '') || '|' || COALESCE("STG_ACCOUNT_CLEAN"."EBS_CUSTOMER_ID"::VARCHAR, ''))
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92b038e4-69d4-4a5c-922a-252f68b1667f
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: OSC_PARTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ec9d2d8-7455-462d-bfef-2a7ef74f9843
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc36cceb-30f9-479b-8bfa-9261814eb205
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: HUBSPOT_COMPANY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd4aa9f7-9c27-4cd7-a03c-b577cfe2fe8a
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 027130c1-6bc3-474b-835b-f36c813c9c7e
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e4340f3-e8cd-4cf5-9000-49554b7a80d5
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 380fc34a-655e-4342-8c60-d6f19e9d5151
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fcfff21-55b6-4068-bf2c-44ad20429c3e
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4a767e9-d0fb-4aca-871c-f4f9f1570100
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca0c8e2f-ede5-4939-890f-598db7592e74
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 082b3812-9de1-4886-89f0-b2a3561f2e7a
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: VARCHAR(2048)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3186f80-e85e-45ef-a175-74763fd6c09f
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ee5ca56-debb-4117-8fe4-baae27c98c41
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: INDUSTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be819269-88aa-40e5-926b-38477af74564
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50db6b93-b103-44d2-bf04-38f010e50b06
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6402dfd3-2640-4ae2-af49-ed52ecce3938
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 718e6bc2-f783-4aa9-a372-8cf27001c4b4
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PWSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4fa10c6-1c81-4325-adb3-9f3f948e61c5
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51b19ac1-5ed6-4a4f-add5-0ad309acafe2
          stepCounter: 76a88ce6-53a8-431d-8e3f-a03e60f827c9
        config: {}
        dataType: DATE
        description: ""
        name: LAST_UPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b31df83-2f6a-447b-ae30-6410af3fb8e0
                stepCounter: 001f59ff-a436-483a-8ea6-aa1044fa9202
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_ACCOUNT_CLEAN: 001f59ff-a436-483a-8ea6-aa1044fa9202
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_ACCOUNT_CLEAN
        join:
          joinCondition: FROM {{ ref('USG_STG_MASTER', 'STG_ACCOUNT_CLEAN') }} "STG_ACCOUNT_CLEAN"
        name: STG_ACCOUNT_KEYS
        noLinkRefs: []
  name: STG_ACCOUNT_KEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
