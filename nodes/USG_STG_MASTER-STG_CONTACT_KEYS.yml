fileVersion: 1
id: 610787cd-c11d-464f-b8cb-4b8145ee35ed
name: STG_CONTACT_KEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Create a Contact ID that associates all similar contacts among systems
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdb234c9-f1e0-4f9a-b2a0-340c2220dfdf
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR
        description: ""
        name: CONTACT_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE
                  WHEN "STG_CONTACT_FULL_NAME"."NAME" IS NOT NULL AND "STG_CONTACT_FULL_NAME"."EMAIL_ADDRESS" IS NOT NULL THEN MD5("STG_CONTACT_FULL_NAME"."NAME" || '|' || STG_CONTACT_FULL_NAME."EMAIL_ADDRESS")
                  ELSE MD5(COALESCE("STG_CONTACT_FULL_NAME"."OSC_PARTY_ID"::VARCHAR, '') || '|' || COALESCE("STG_CONTACT_FULL_NAME"."HUBSPOT_CONTACT_ID"::VARCHAR, '') || '|' || COALESCE("STG_CONTACT_FULL_NAME"."EPA_PWSID", ''))
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3fe8bd8-ac0c-49f5-8771-5df92b6faa09
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: OSC_PARTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ae96bf4-1f43-4d09-bc3c-ddec9e2e35bf
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b779aa1f-ad05-4309-ad86-64b20954cb68
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: HUBSPOT_CONTACT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c3ade5f-e83c-4490-8d93-ea4899c8f54a
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff5b398e-5453-4821-88d6-52bea5d11fa3
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR
        description: ""
        name: EPA_PWSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f923efb3-22bd-4560-8bd8-99af9d7e6814
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47187bd4-06d9-4440-9bad-a5bac3f4ca2a
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR
        description: ""
        name: CONTACT_OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 351fcbc8-1d79-4b91-a84f-eeb39cf29fe5
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6414f253-ad3b-4f64-b3db-d2f296169605
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc26abd3-f8fe-47de-9cae-0840a090bd80
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef1d7cf6-df86-4a6d-bd14-21380a6db976
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: EMAIL_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45d1b965-b663-4b95-a49e-e68f263f0f56
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1e37da4-a2e4-428d-8c2e-e2181cc68159
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: JOB_TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a714d775-6f81-4361-ba8a-a947d3c88d61
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac204f47-b385-4397-a10f-4bf25aaf2551
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 890ed127-12e4-44c3-aba6-2fc7780fff8a
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3efcd10c-bf09-4f95-8592-a6025ad1b582
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRIMARY_CUSTOMER_RELATIONSHIP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb4eced-5996-4f82-9afe-ab5de15dacce
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b2d7889-3a96-4ce0-a1fb-a410e2dc2735
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PHONE_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 659804fb-d6ac-4989-a860-49ff50f5bc19
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6f415c4-e54f-4452-9e5c-f41c420087c2
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PHONE_AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc79dfda-3b4b-4a55-a06d-0bc53b1f7ee2
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 002427dc-4a41-42fe-b786-8d441cd9a8a7
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PHONE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be384b0a-2efc-483c-a203-cea957f8520b
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a29432f4-47b8-4b12-9df7-c4337ece906a
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PHONE_EXTENSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35e03991-8fcb-4bfc-96fc-cb16ffa09144
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f93ac1fd-0929-495b-b02f-55072cf28bd5
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: PHONE_LINE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49341e2d-9c67-433e-8db4-8ba4bfd654fb
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 29d3b13c-1180-4876-b9a4-d3af41b7abdd
          stepCounter: 610787cd-c11d-464f-b8cb-4b8145ee35ed
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: LAST_UPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ea5d3d2-8ff9-409b-bb0a-741d341e2bf8
                stepCounter: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
            transform: ""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_CONTACT_FULL_NAME: 35ccbd2e-92c1-4aab-bd49-a603c7f08d49
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_CONTACT_FULL_NAME
        join:
          joinCondition: FROM {{ ref('USG_STG_MASTER', 'STG_CONTACT_FULL_NAME') }} "STG_CONTACT_FULL_NAME"
        name: STG_CONTACT_KEYS
        noLinkRefs: []
  name: STG_CONTACT_KEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
