fileVersion: 1
id: 71247957-c2ca-4285-b03d-5cb2109869da
name: STG_ASSETS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5ab73b6-6f60-493d-a064-f85a946fc4cc
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: VARCHAR
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7048277d-9b95-4810-bdc8-e43a112be4b2
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbadba58-d53f-4737-b1b0-d7229f9cf582
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: VARCHAR
        description: ""
        name: ADDRESS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5391c4dc-1d10-4414-95d0-2066f116870e
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5204d4b-3bde-4f0a-955b-ea1f5be0e4f2
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_PARTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e564b53-17a8-4cf3-9021-c46f47a52ce0
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 349f7457-a84f-454c-9ff7-4106fa9025b1
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c6d314a-6d1c-4d2e-97a0-68322968f3dc
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d598b193-03c5-4e8e-9929-bf4cf1fe59d1
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9de8a161-d1f7-4f22-9928-05a95163eed1
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a80d4491-361b-44ec-b19e-a9da49399c17
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_PARTY_SITE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 972fb5ab-6152-4aed-b54a-59dd87fadad4
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5baddb33-31b4-45e9-a187-dbe35e70bdad
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: EBS_CUSTOMER_SITE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dde347d-206d-4125-a08c-febd9a91e734
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f9a9fcd-0623-4e16-b8b9-842cda689c03
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ASSET_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ef49c62-8fdc-4687-88dc-970f309331cc
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9e9f718-e481-4bdd-a7ab-603b73f4d10c
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: VARCHAR(256)
        description: Contains mapping to normalize asset types
        name: ASSET_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da9a2561-ba3e-49b5-a4f8-a66c99502194
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: |-
              CASE
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" IS NULL THEN NULL
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%STANDPIPE%' THEN 'Standpipe'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%ELEVATED%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%GROUND STORAGE%' THEN 'Ground Storage'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%PRESSURE%' THEN 'Pressure'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%GST%' THEN 'Ground Storage'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%HYDROPNEUMATIC%' THEN 'Pressure'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%COMPOSITE%' THEN 'Composite Hydropillar'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%HYDROPILLAR%' THEN 'Hydropillar'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%FLUTED%' THEN 'Hydropillar'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%PEDESTAL%' THEN 'Pedisphere'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%STP%' THEN 'STP'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%PEDISPHERE%' THEN 'Pedisphere'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%EST%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%ELV%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%CONCRETE%' THEN 'Concrete'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%ELEV%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%NULL NULL%' THEN 'Not Specified'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%ELLIPSOIDAL%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%MULTI-LEG%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%WATERSPHERE%' THEN 'Pedisphere'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%SINGLE PED%' THEN 'Pedisphere'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%WELL%' THEN 'Well'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%RESERVOIR%' THEN 'Ground Storage'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%HYDRO%' THEN 'Hydropillar'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%PED%' THEN 'Pedisphere'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%PEDI%' THEN 'Pedisphere'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%ELE%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%PV%' THEN 'Pressure'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%TOROPILLAR%' THEN 'Elevated'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%G S T%' THEN 'Ground Storage'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%GROUND%' THEN 'Ground Storage'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%COMP%' THEN 'Composite Hydropillar'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%HORIZONTAL%' THEN 'Pressure'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%STDP%' THEN 'Standpipe'
                  WHEN "STG_EBS_ASSETS"."ASSET_TYPE" ILIKE '%SP%' THEN 'Standpipe'
                  ELSE 'Other'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b590db7-dc3c-40b9-b481-eff52255090d
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: NUMBER
        description: ""
        name: ASSET_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 449cedd8-c517-4221-809f-e6069448a63a
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e32969d-3cfd-4fc7-8949-f5242845d39e
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: VARCHAR(256)
        description: Contains mapping to normalize asset sizes
        name: ASSET_SIZE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 449cedd8-c517-4221-809f-e6069448a63a
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: |-
              CASE
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" IS NULL THEN NULL
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 95000 THEN '< 95,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 175000 THEN '> 95,000 <= 175,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 375000 THEN '> 175,000 <= 375,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 675000 THEN '> 375,000 <= 675,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 975000 THEN '> 675,000 <= 975,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 1275000 THEN '> 975,000 <=1,275,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 1975000 THEN '> 1,275,000 <= 1,975,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 3750000 THEN '> 1,975,000 <= 3,750,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 6750000 THEN '> 3,750,000 <= 6,750,000'
                  WHEN "STG_EBS_ASSETS"."ASSET_SIZE" <= 9750000 THEN '> 6,750,000 <= 9,750,000'
                  ELSE '> 9,750,000'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2d2914d-ca64-481f-8fec-fe32bfa84899
          stepCounter: 71247957-c2ca-4285-b03d-5cb2109869da
        config: {}
        dataType: DATE
        description: ""
        name: LAST_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5cc6174-d4be-489d-9f25-24eea9577ff0
                stepCounter: 059ad469-00c4-4bed-8f7e-908f7a2ad948
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_ORACLE_EBS
            nodeName: STG_EBS_ASSETS
        join:
          joinCondition: FROM {{ ref('USG_STG_ORACLE_EBS', 'STG_EBS_ASSETS') }} "STG_EBS_ASSETS"
        name: STG_ASSETS
        noLinkRefs: []
  name: STG_ASSETS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
