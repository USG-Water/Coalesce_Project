fileVersion: 1
id: 64e22541-8637-439a-badc-ec567a01aee1
name: STG_RW_PSO_WEEKLY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c09d259-69b5-4334-a770-bb10925544ef
          stepCounter: 64e22541-8637-439a-badc-ec567a01aee1
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 620e5d55-138a-4751-95fe-866d98ba8522
                stepCounter: 3a668e4b-3818-4c93-9f79-072bf40ff5ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29887f9b-707d-4519-bf84-b22e92b4f583
          stepCounter: 64e22541-8637-439a-badc-ec567a01aee1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f90bfa65-0ecf-41a2-ad8f-ba21f1a06b1c
                stepCounter: 3a668e4b-3818-4c93-9f79-072bf40ff5ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8976967b-c01d-4e4d-95a9-a1d2e543324c
          stepCounter: 64e22541-8637-439a-badc-ec567a01aee1
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25bee886-da54-46cb-be3c-68f6912e7773
                stepCounter: 3a668e4b-3818-4c93-9f79-072bf40ff5ed
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cdc7258e-946e-47a6-8d6d-cc45a6da59b6
          stepCounter: 64e22541-8637-439a-badc-ec567a01aee1
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: QUARTER_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 861d0a43-72b0-4787-948f-4d93d967ad01
                stepCounter: 3a668e4b-3818-4c93-9f79-072bf40ff5ed
            transform: ""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b0beb82-4fdb-458c-aa5b-ef712e4126a6
          stepCounter: 64e22541-8637-439a-badc-ec567a01aee1
        config: {}
        dataType: DATE
        description: ""
        name: QUARTER_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a1b77a2-a561-474c-a849-940d3688d085
                stepCounter: 3a668e4b-3818-4c93-9f79-072bf40ff5ed
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b660dd33-0acc-406d-bca9-85e2248c4d89
          stepCounter: 64e22541-8637-439a-badc-ec567a01aee1
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: WEEK_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              DATEADD(
                  WEEK,
                  "SEQ"."SEQ",
                  DATE_TRUNC('WEEK', "STG_RW_PSO"."QUARTER_START")
              )
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d76aaf2-f599-41ac-bf2a-4eab6abfcb0f
          stepCounter: 64e22541-8637-439a-badc-ec567a01aee1
        config: {}
        dataType: FLOAT
        description: ""
        name: AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3152e487-9957-4e17-b189-0ca7f20bcfb1
                stepCounter: 3a668e4b-3818-4c93-9f79-072bf40ff5ed
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_RW_PSO: 3a668e4b-3818-4c93-9f79-072bf40ff5ed
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_RW_PSO
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_MASTER', 'STG_RW_PSO') }} "STG_RW_PSO"
            JOIN (
                SELECT SEQ4() AS "SEQ"
                FROM TABLE(GENERATOR(ROWCOUNT => 20))
            ) "SEQ"
            WHERE DATEADD(
                    WEEK,
                    "SEQ"."SEQ",
                    DATE_TRUNC('WEEK', "STG_RW_PSO"."QUARTER_START")
                  ) <= "STG_RW_PSO"."QUARTER_END"
        name: STG_RW_PSO_WEEKLY
        noLinkRefs: []
  name: STG_RW_PSO_WEEKLY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
