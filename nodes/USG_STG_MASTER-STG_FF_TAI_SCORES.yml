fileVersion: 1
id: 967503b0-d346-4890-a3cb-be8b5c88885b
name: STG_FF_TAI_SCORES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: USG_STG_MASTER
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea0e4adf-01c8-40ce-9ba3-56c45cd8fb60
          stepCounter: 967503b0-d346-4890-a3cb-be8b5c88885b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PROJECT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bde71e-7035-4059-9b10-34b98d4cbb0a
                stepCounter: 02ac953e-0373-40b5-81e6-f78a302fec88
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: facbb4c5-fac2-46a9-b0bd-144943e0c677
          stepCounter: 967503b0-d346-4890-a3cb-be8b5c88885b
        config: {}
        dataType: FLOAT
        description: ""
        name: INTERIOR_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROUND(SUM(CASE WHEN "STG_TANK_ASSESSMENTS"."INTERIOR_EXTERIOR_INTERIOR_DRY" = 'Interior' THEN "STG_TANK_ASSESSMENTS"."SCORE" ELSE 0 END) / NULLIF(SUM(CASE WHEN "STG_TANK_ASSESSMENTS"."INTERIOR_EXTERIOR_INTERIOR_DRY" = 'Interior' THEN "STG_TANK_ASSESSMENTS"."MAX_SCORE" ELSE 0 END), 0) * 5, 2)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 703a3398-a8d9-46fb-a77c-3d31b400277f
          stepCounter: 967503b0-d346-4890-a3cb-be8b5c88885b
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: EXTERIOR_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROUND(SUM(CASE WHEN "STG_TANK_ASSESSMENTS"."INTERIOR_EXTERIOR_INTERIOR_DRY" = 'Exterior' THEN "STG_TANK_ASSESSMENTS"."SCORE" ELSE 0 END) / NULLIF(SUM(CASE WHEN "STG_TANK_ASSESSMENTS"."INTERIOR_EXTERIOR_INTERIOR_DRY" = 'Exterior' THEN "STG_TANK_ASSESSMENTS"."MAX_SCORE" ELSE 0 END), 0) * 5, 2)
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba8333f5-e223-4d54-81b4-0ed96c5f8be3
          stepCounter: 967503b0-d346-4890-a3cb-be8b5c88885b
        config: {}
        dataType: DATE
        description: ""
        name: ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f34e59ca-0884-43f2-a38b-c506ef0f16d0
                stepCounter: 02ac953e-0373-40b5-81e6-f78a302fec88
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_TANK_ASSESSMENTS: 02ac953e-0373-40b5-81e6-f78a302fec88
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: USG_STG_MASTER
            nodeName: STG_TANK_ASSESSMENTS
        join:
          joinCondition: |-
            FROM {{ ref('USG_STG_MASTER', 'STG_TANK_ASSESSMENTS') }} "STG_TANK_ASSESSMENTS"
            GROUP BY "STG_TANK_ASSESSMENTS"."PROJECT_ID", "STG_TANK_ASSESSMENTS"."ASSESSMENT_DATE"
        name: STG_FF_TAI_SCORES
        noLinkRefs: []
  name: STG_FF_TAI_SCORES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
